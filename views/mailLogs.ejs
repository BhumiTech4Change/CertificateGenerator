<table id="mailLogs" class="table" border="1">
    <tr>
        <th style="border: none; border-radius: 20px 0px 0px 0px;"> To </th>
        <th style="border: none;"> Category </th>
        <th style="border: none; border-radius: 0px 20px 0px 0px;"> Response </th>
    </tr>
    <% mail[0].mails.forEach(function(m) { %>
    <tr>
        <td> <%= m.toEmail %> </td>
        <td> <%= m.category %> </td>
        <% if(m.category=="SENT") { %>
        <td> <%= m.msgID %> </td>
        <% } else{ %>
        <td> <%= m.error %> </td>
        <% } %>
    </tr>
    <% }) %>
</table>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.8/xlsx.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/TableExport/5.2.0/js/tableexport.min.js"></script>

<script>
    // function exportTableToExcel() {
    //     // get table
    //     var table = document.getElementById('mailLogs');
    //     // convert table to excel sheet
    //     var wb = XLSX.utils.table_to_book(table, {sheet:"Sheet1"});
    //     // write sheet to blob
    //     var blob = new Blob([s2ab(XLSX.write(wb, {bookType:'xlsx', type:'binary'}))], {
    //         type: "application/octet-stream"
    //     });
    //     // return sheet file
    //     return saveAs(blob, "example.xlsx");
    // }

    // function s2ab(s) {
    //     var buf = new ArrayBuffer(s.length);
    //     var view = new Uint8Array(buf);
    //     for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
    //     return buf;
    // }
        //////////
    // function exportTableToExcel(mailLogs, filename = ''){
    // var downloadLink;
    // var dataType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';
    // var tableSelect = document.getElementById(mailLogs);
    // var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');
    
    // // Specify file name
    // filename = filename?filename+'.xls':'excel_data.xls';
    
    // // Create download link element
    // downloadLink = document.createElement("a");
    
    // document.body.appendChild(downloadLink);
    
    // if(navigator.msSaveOrOpenBlob){
    //     var blob = new Blob(['\ufeff', tableHTML], {
    //         type: dataType
    //     });
    //     navigator.msSaveOrOpenBlob( blob, filename);
    // }else{
    //     // Create a link to the file
    //     downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
    
    //     // Setting the file name
    //     downloadLink.download = filename;
        
    //     //triggering the function
    //     downloadLink.click();
    // }
    // }
    /////////////////
    TableExport(document.getElementById('mailLogs'), {
        formats: ["csv"],
        position: "top"
    })
</script>